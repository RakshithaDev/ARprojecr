<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>AR Artwork â€” Hard-coded Comments (Step 1)</title>

<!-- A-Frame & MindAR -->
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
  :root{
    --peach1:#ffd7bd; --peach2:#ffc6e0; --text:#ffffff; --muted:#eae5ee;
  }
  html,body{margin:0;height:100%;font-family:system-ui,-apple-system,Segoe UI,Roboto}
  .a-enter-vr,.a-enter-vr-button,.a-enter-ar,.a-enter-ar-button{display:none!important}

  /* small top hint */
  #hint{position:fixed;top:12px;left:50%;transform:translateX(-50%);
        background:rgba(0,0,0,.55);color:#fff;padding:6px 10px;border-radius:999px;z-index:3}

  /* floating action button (the orb) */
  #fab{
    position:fixed;left:50%;bottom:24px;transform:translateX(-50%);
    width:68px;height:68px;border-radius:50%;
    background:radial-gradient(120% 120% at 30% 30%, #ffb2d9, #ffcf9a 55%, #b6c8ff);
    box-shadow:0 16px 40px rgba(255,160,200,.45), 0 6px 18px rgba(0,0,0,.35);
    border:1px solid rgba(255,255,255,.35); z-index:3; display:none; /* shown on targetFound */
  }
  #toast{position:fixed;left:50%;bottom:110px;transform:translateX(-50%) translateY(18px);
         background:rgba(15,18,26,.92);color:#fff;border:1px solid #263044;
         padding:10px 14px;border-radius:12px;opacity:0;transition:.25s;z-index:4}
  #toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
</style>
</head>
<body>

<div id="hint">Point your camera at the artwork</div>
<div id="fab" aria-label="Share your thoughts"></div>
<div id="toast">Coming soonâ€¦</div>

<!-- IMPORTANT: set imageTargetSrc to YOUR .mind file path -->
<a-scene
  mindar-image="imageTargetSrc: ./targets%20(6).mind"
  renderer="colorManagement:true, physicallyCorrectLights:true"
  vr-mode-ui="enabled:false"
  device-orientation-permission-ui="enabled:true"
  embedded
  id="scene">
  <a-camera look-controls="enabled:false"></a-camera>

  <!-- Anchor that locks to the artwork -->
  <a-entity id="anchor" mindar-image-target="targetIndex: 0"></a-entity>
</a-scene>

<script>
  /* ---------- CONFIG: your hard-coded comments for step 1 ---------- */
  const BUBBLES = [
    {
      title: "Zen â€” the artist",
      text:  `"This piece explores the interplay of displacement, everyday objects and\nnostalgic wonder."`,
      pos:   {x:-0.22, y: 0.25, z:0.02},  // top-left
      width: 0.95, height: 0.40
    },
    {
      title: "Curatorâ€™s Note",
      text:  `"A quiet yet defiant work that turns ordinary retail bags into a field for memory,\nresilience and becoming."`,
      pos:   {x: 0.00, y:-0.28, z:0.02},  // bottom-center
      width: 1.05, height: 0.44
    }
  ];

  /* ---------- cute speech-bubble background as inline SVG texture ---------- */
  const bubbleCache = {};
  function bubbleDataURL(fill1, fill2){
    const k = fill1+"|"+fill2; if(bubbleCache[k]) return bubbleCache[k];
    const svg =
    `<svg xmlns='http://www.w3.org/2000/svg' width='900' height='380' viewBox='0 0 900 380'>
      <defs>
        <linearGradient id='g' x1='0' y1='0' x2='0' y2='1'>
          <stop offset='0%' stop-color='${fill1}'/><stop offset='100%' stop-color='${fill2}' stop-opacity='.92'/>
        </linearGradient>
        <filter id='soft' x='-10%' y='-10%' width='120%' height='120%'>
          <feGaussianBlur stdDeviation='5'/>
        </filter>
      </defs>
      <rect x='20' y='20' width='860' height='300' rx='36' fill='url(#g)' filter='url(#soft)' opacity='.98'/>
      <rect x='20' y='20' width='860' height='300' rx='36' fill='url(#g)' stroke='#ffffff' stroke-opacity='.35' stroke-width='5'/>
      <path d='M 460 320 L 520 320 L 490 360 Z' fill='url(#g)' stroke='#ffffff' stroke-opacity='.35' stroke-width='5' stroke-linejoin='round'/>
    </svg>`;
    return bubbleCache[k] = "data:image/svg+xml;utf8," + encodeURIComponent(svg);
  }

  /* ---------- add one bubble group (bg + title + body + tiny icons) ---------- */
  function addBubble(anchor, spec, paletteIndex=0){
    const pastel = [
      ["#FFE1C9","#FFC9E6"], // peach â†’ rose
      ["#EAF5FF","#D7E0FF"], // blue-ish
      ["#E9FFF5","#CFEFE3"]  // mint
    ][paletteIndex % 3];

    const g = document.createElement("a-entity");
    g.setAttribute("position", `${spec.pos.x} ${spec.pos.y} ${spec.pos.z}`);

    // background
    const bg = document.createElement("a-image");
    bg.setAttribute("src", bubbleDataURL(pastel[0], pastel[1]));
    bg.setAttribute("width", spec.width);
    bg.setAttribute("height", spec.height);
    bg.setAttribute("material", "transparent:true; opacity:1; side:double");
    g.appendChild(bg);

    // title
    const title = document.createElement("a-text");
    title.setAttribute("value", spec.title);
    title.setAttribute("color", "#ffffff");
    title.setAttribute("align", "left");
    title.setAttribute("width", 1.6);
    title.setAttribute("font-weight", "bold");
    title.setAttribute("position", `${-spec.width/2 + 0.12} ${spec.height/2 - 0.12} 0.01`);
    g.appendChild(title);

    // body
    const body = document.createElement("a-text");
    body.setAttribute("value", spec.text);
    body.setAttribute("color", "#f3eef6");
    body.setAttribute("align", "left");
    body.setAttribute("width", 1.6);
    body.setAttribute("wrap-count", 34);
    body.setAttribute("position", `${-spec.width/2 + 0.12} ${spec.height/2 - 0.26} 0.01`);
    g.appendChild(body);

    // tiny icon row (emoji placeholders)
    const icons = document.createElement("a-text");
    icons.setAttribute("value", "â™¡   ðŸ’¬   â†—ï¸Ž");
    icons.setAttribute("color", "#ffffff");
    icons.setAttribute("opacity", "0.85");
    icons.setAttribute("align", "left");
    icons.setAttribute("width", 1.6);
    icons.setAttribute("position", `${-spec.width/2 + 0.12} ${-spec.height/2 + 0.10} 0.01`);
    g.appendChild(icons);

    // subtle bob animation
    g.setAttribute("animation", "property: position; dir: alternate; dur: 2200; easing: easeInOutSine; loop: true; to: " +
      `${spec.pos.x} ${spec.pos.y + 0.02} ${spec.pos.z}`);

    anchor.appendChild(g);
  }

  /* ---------- show/hide on target events; FAB behavior ---------- */
  const anchor = document.getElementById('anchor');
  const hint   = document.getElementById('hint');
  const fab    = document.getElementById('fab');
  const toast  = document.getElementById('toast');

  anchor.addEventListener('targetFound', ()=>{
    hint.style.display = 'none';
    fab.style.display  = 'block';

    // add our hard-coded bubbles once
    if (!anchor.__seeded){
      BUBBLES.forEach((b,i)=> addBubble(anchor, b, i));
      anchor.__seeded = true;
    }
  });
  anchor.addEventListener('targetLost', ()=>{
    hint.style.display = 'block';
    fab.style.display  = 'none';
  });

  fab.addEventListener('click', ()=>{
    toast.textContent = "Share your thoughts â€” coming soon";
    toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'), 1600);
  });
</script>
</body>
</html>
